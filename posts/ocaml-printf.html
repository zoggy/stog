<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="application/xhtml+xml; charset=utf-8" http-equiv="Content-Type"/>
<title>Stog : ocaml-printf</title>
<link href="https://zoggy.github.io/stog/style.css" rel="stylesheet" type="text/css"/>
</head>
<script type="text/javascript">
function submitSearch(){
    var q = document.getElementById('q');
    q.value =q.value + " site:https://zoggy.github.io/stog ";
    return true;
}
</script>
<body>
<div id="page">
<div class="navbar navbar-fixed-top">
<div class="navbar-inner">
<div class="container">

<!--&lt;image float="right" src="&lt;site-url/&gt;/stog-logo.svg" width="30"/&gt;-->

  <div class="nav-collapse">
    <ul class="nav">
    <li class="&lt;navbar-home/&gt;"><a href="https://zoggy.github.io/stog/index.html">Stog</a></li>
    <li class="&lt;navbar-install/&gt;"><a href="https://zoggy.github.io/stog/install.html">Installation</a></li>
    <li class="&lt;navbar-doc/&gt;"><a href="https://zoggy.github.io/stog/doc.html">Documentation</a></li>
    <li class="&lt;navbar-plugins/&gt;"><a href="https://zoggy.github.io/stog/plugins.html">Plugins</a></li>
    <li class="active"><a href="https://zoggy.github.io/stog/blog.html">Blog</a></li>
    <li class="&lt;navbar-about/&gt;"><a href="https://zoggy.github.io/stog/about.html">?</a></li>
    </ul>
<!--
    &lt;div class="nav pull-right"&gt;
       &lt;form action="https://qwant.com/" method="GET"
         onsubmit="submitSearch();"
         style="overflow:hidden;margin:0;margin-top:5px;padding:0;height:28px;display:flex;"
         frameborder="0"&gt;
         &lt;input style="width: 100px;" type="text" id="q" placeHolder="Search" name="q"/&gt;
         &lt;input style="font-size: 0.8em" type="submit" value="ðŸ”Ž"/&gt;
       &lt;/form&gt;
    &lt;/div&gt;
-->
  </div>

</div>
</div>
</div>

<div id="header">
  
  
  <div class="doc-navbar">
      <div class="navleft"><a href="https://zoggy.github.io/stog/posts/stog-rdf-0.9.0.html">Stog-rdf 0.9.0</a></div>
      <div class="navright"><a href="https://zoggy.github.io/stog/posts/release-0.10.0.html">Stog 0.10.0</a></div>
    </div>
  <div class="page-title">ocaml-printf</div>
</div>

<div class="date">January 16, 2014</div>


<p>
Since <a href="https://zoggy.github.io/stog/posts/release-0.10.0.html">Stog 0.10.0</a>, the <span class="icode"><span class="hl kwa">&lt;ocaml-printf</span><span class="hl kwa">&gt;</span></span> rule
can be used to access the content of computed OCaml values, as
strings.
</p>


<ul class="toc"><li class="toc-section"><a href="https://zoggy.github.io/stog/posts/ocaml-printf.html#first">First example</a></li><li class="toc-section"><a href="https://zoggy.github.io/stog/posts/ocaml-printf.html#formats">Formatting</a></li><li class="toc-section"><a href="https://zoggy.github.io/stog/posts/ocaml-printf.html#xml">Using result as XML</a></li><li class="toc-section"><a href="https://zoggy.github.io/stog/posts/ocaml-printf.html#sessions">Sessions</a></li></ul>
<div class="section"><div aria-level="1" class="section-title" id="first" role="heading">First example</div>
<p>
Let's take a first example. Suppose we evaluated some OCaml code
with the following rule:
</p>
<div class="hide" id="code1"><![CDATA[
<ocaml-eval show-code="false">let x = "Hello world!";;</ocaml-eval>
]]></div>
<pre class="code-xml"><span class="hl kwa">&lt;ocaml-eval</span><span class="hl std"> </span><span class="">show-code</span><span class="hl std">=</span><span class="hl str">"false"</span><span class="hl kwa">&gt;</span><span class="hl std">let x = "Hello world!";;</span><span class="hl kwa">&lt;/ocaml-eval</span><span class="hl kwa">&gt;</span><span class="hl std">
</span></pre>


<p>
Now we can get the contents of <code>x</code> as a string
to include in our document using the new rule:
</p>
<div class="hide" id="code1p"><![CDATA[
The value of <code>x</code> is: <ocaml-printf>x</ocaml-printf>
]]></div>
<pre class="code-xml"><span class="hl std">The value of </span><span class="hl kwa">&lt;code</span><span class="hl kwa">&gt;</span><span class="hl std">x</span><span class="hl kwa">&lt;/code</span><span class="hl kwa">&gt;</span><span class="hl std"> is: </span><span class="hl kwa">&lt;ocaml-printf</span><span class="hl kwa">&gt;</span><span class="hl std">x</span><span class="hl kwa">&lt;/ocaml-printf</span><span class="hl kwa">&gt;</span><span class="hl std">
</span></pre>
â†³ 
The value of <code>x</code> is: Hello world!

</div>

<div class="section"><div aria-level="1" class="section-title" id="formats" role="heading">Formatting</div>
<p>
The <span class="icode"><span class="hl kwa">&lt;ocaml-printf</span><span class="hl kwa">&gt;</span></span> rule builds some OCaml code of the form:
</p>
<pre class="code-ocaml"><span class="hl kwd">Printf</span>sprintf <span class="hl str">"&lt;format"</span> &lt;code<span class="hl opt"/></pre>
<p>The <code>&lt;code&gt;</code> is the contents of the <span class="icode"><span class="hl kwa">&lt;ocaml-printf</span><span class="hl kwa">&gt;</span></span>
node, and <code>&lt;format&gt;</code> is <code>%s</code> by default.
Another format can be used by setting the <code>format</code> attribute
like in the following example:
</p>
<div class="hide" id="code2p"><![CDATA[
1 + 2 = <ocaml-printf format="%d">(1+2)</ocaml-printf>
]]></div>
<pre class="code-xml"><span class="hl std">1 + 2 = </span><span class="hl kwa">&lt;ocaml-printf</span><span class="hl std"> </span><span class="">format</span><span class="hl std">=</span><span class="hl str">"%d"</span><span class="hl kwa">&gt;</span><span class="hl std">(1+2)</span><span class="hl kwa">&lt;/ocaml-printf</span><span class="hl kwa">&gt;</span><span class="hl std">
</span></pre>
â†³ 
1 + 2 = 3

<p>Note that the parentheses around the expression in the <span class="icode"><span class="hl kwa">&lt;ocaml-printf</span><span class="hl kwa">&gt;</span></span>
node is mandatory, otherwise the <span class="icode"><span class="hl kwc">Printf</span><span class="hl std">.</span><span class="">sprintf</span><span class="hl std"> </span><span class="hl str">"%d"</span><span class="hl std"> </span><span class="hl num">1</span><span class="hl num">+2</span></span>
would result in an error.
</p>
<p>
Of course more compilated format and ocaml expressions can be used:
</p>
<pre class="code-ocaml"><span># <span class="hl kwa">let</span> y <span class="hl opt">=</span> <span class="hl num">1</span> <span class="hl kwa">and</span> z <span class="hl opt">=</span> <span class="hl num">21</span><span class="hl opt">;;</span></span>
<span class="ocaml-toplevel"><span class="toplevel-out">val y : int = 1
val z : float = 21.</span></span></pre>
<div class="hide" id="code3p"><![CDATA[
<ocaml-printf format="The result of %d + %.2f is %.0f.">y z ((float y) +. z)</ocaml-printf>
]]></div>
<pre class="code-xml"><span class="hl kwa">&lt;ocaml-printf</span><span class="hl std"> </span><span class="">format</span><span class="hl std">=</span><span class="hl str">"The result of %d + %.2f is %.0f."</span><span class="hl kwa">&gt;</span><span class="hl std">y z ((float y) +. z)</span><span class="hl kwa">&lt;/ocaml-printf</span><span class="hl kwa">&gt;</span><span class="hl std">
</span></pre>
â†³ The result of 1 + 21.00 is 22.

</div>

<div class="section"><div aria-level="1" class="section-title" id="xml" role="heading">Using result as XML</div>
<p>
The result of <span class="icode"><span class="hl kwa">&lt;ocaml-printf</span><span class="hl kwa">&gt;</span></span> is considered as CDATA in the XML document:
</p>
<pre class="code-xml"><span class="hl kwa">&lt;ocaml-printf</span><span class="hl std"> </span><span class="hl kwa">&gt;</span><span class="hl std">&lt;![CDATA[("</span><span class="hl kwa">&lt;strong</span><span class="hl kwa">&gt;</span><span class="hl std">" ^ x ^ "</span><span class="hl kwa">&lt;/strong</span><span class="hl kwa">&gt;</span><span class="hl std">")]]&gt;</span><span class="hl kwa">&lt;/ocaml-printf</span><span class="hl kwa">&gt;</span><span class="hl std">
</span></pre>
<p>
is rewritten &lt;strong&gt;Hello world!&lt;/strong&gt;
</p>
<p>
Let's define a list:
</p>
<pre class="code-ocaml"><span># <span class="hl kwa">let</span> my_list <span class="hl opt">= [</span> <span class="hl num">101</span> <span class="hl opt">;</span> <span class="hl num">202</span> <span class="hl opt">;</span> <span class="hl num">303</span> <span class="hl opt">;</span> <span class="hl num">404</span> <span class="hl opt">];;</span></span>
<span class="ocaml-toplevel"><span class="toplevel-out">val my_list : int list = [101; 202; 303; 404]</span></span></pre>
<p>The <a href="https://zoggy.github.io/stog/module_base.html#as-xml"><span class="icode"><span class="hl kwa">&lt;as-xml</span><span class="hl kwa">&gt;</span></span></a> rule can be used to
parse the result of <span class="icode"><span class="hl kwa">&lt;ocaml-printf</span><span class="hl kwa">&gt;</span></span> as XML, using the <code>defer_</code>
attribute to compute the contents of the node first:
</p>
<pre class="code-xml" id="code5p"><span class="hl kwa">&lt;table</span><span class="hl std"> </span><span class="">class</span><span class="hl std">=</span><span class="hl str">"table table-bordered table-striped"</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;tr</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;th</span><span class="hl kwa">&gt;</span><span class="hl std">N</span><span class="hl kwa">&lt;/th</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;th</span><span class="hl kwa">&gt;</span><span class="hl std">N^2</span><span class="hl kwa">&lt;/th</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;th</span><span class="hl kwa">&gt;</span><span class="hl std">Toplevel</span><span class="hl kwa">&lt;/th</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;/tr</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;as-xml</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"1"</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;ocaml-printf</span><span class="hl kwa">&gt;</span><span class="hl std">&lt;![CDATA[
  (String.concat ""
    (List.map
      (fun n -&gt;
        "</span><span class="hl kwa">&lt;tr</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;td</span><span class="hl kwa">&gt;</span><span class="hl std">"^(string_of_int n)^"</span><span class="hl kwa">&lt;/td</span><span class="hl kwa">&gt;</span><span class="hl std">"^
        "</span><span class="hl kwa">&lt;td</span><span class="hl kwa">&gt;</span><span class="hl std">"^(string_of_int (n*n))^"</span><span class="hl kwa">&lt;/td</span><span class="hl kwa">&gt;</span><span class="hl std">"^
        "</span><span class="hl kwa">&lt;td</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;ocaml-eval</span><span class="hl std"> </span><span class="">toplevel</span><span class="hl std">=\</span><span class="hl str">"true\"</span><span class="hl kwa">&gt;</span><span class="hl std">
            let foo = "^(string_of_int n)^"</span><span class="hl kwa">&lt;/ocaml-eval</span><span class="hl kwa">&gt;</span><span class="hl std">
         </span><span class="hl kwa">&lt;/td</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;/tr</span><span class="hl kwa">&gt;</span><span class="hl std">")
      my_list))
]]&gt;</span><span class="hl kwa">&lt;/ocaml-printf</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;/as-xml</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;/table</span><span class="hl kwa">&gt;</span><span class="hl std">

</span></pre>
<p>This gives the following table:</p>
<table class="table table-bordered table-striped">
<tr><th>N</th><th>N^2</th><th>Toplevel</th></tr>
<tr><td>101</td><td>10201</td><td><pre class="code-ocaml"><span># <span class="hl kwa">let</span> foo <span class="hl opt">=</span> <span class="hl num">101</span><span class="hl opt">;;</span></span>
<span class="ocaml-toplevel"><span class="toplevel-out">val foo : int = 101</span></span></pre>
         </td></tr><tr><td>202</td><td>40804</td><td><pre class="code-ocaml"><span># <span class="hl kwa">let</span> foo <span class="hl opt">=</span> <span class="hl num">202</span><span class="hl opt">;;</span></span>
<span class="ocaml-toplevel"><span class="toplevel-out">val foo : int = 202</span></span></pre>
         </td></tr><tr><td>303</td><td>91809</td><td><pre class="code-ocaml"><span># <span class="hl kwa">let</span> foo <span class="hl opt">=</span> <span class="hl num">303</span><span class="hl opt">;;</span></span>
<span class="ocaml-toplevel"><span class="toplevel-out">val foo : int = 303</span></span></pre>
         </td></tr><tr><td>404</td><td>163216</td><td><pre class="code-ocaml"><span># <span class="hl kwa">let</span> foo <span class="hl opt">=</span> <span class="hl num">404</span><span class="hl opt">;;</span></span>
<span class="ocaml-toplevel"><span class="toplevel-out">val foo : int = 404</span></span></pre>
         </td></tr>
</table>

<p>
As shown above, the parsed XML is then rewritten during the rest of the
evaluation process.
The current value of <code>foo</code> is
404.
</p>
</div>

<div class="section"><div aria-level="1" class="section-title" id="sessions" role="heading">Sessions</div>
<p>
The <code>session</code> attribute is honored:
</p>
<pre class="code-xml"><span class="hl kwa">&lt;ocaml-printf</span><span class="hl std"> </span><span class="">session</span><span class="hl std">=</span><span class="hl str">"..."</span><span class="hl std"> ...</span><span class="hl kwa">&gt;</span><span class="hl std">...</span><span class="hl kwa">&lt;/ocaml-printf</span><span class="hl kwa">&gt;</span></pre>
<p>See <a href="https://zoggy.github.io/stog/posts/ocaml-sessions.html">this post</a> for details about OCaml sessions.</p>
</div>







<p class="doccode alert alert-info">
For information you can see the <a href="#pagesource"> source code of the page</a>.
</p>
<div id="pagesource">
  <pre class="code-xml"><span class="hl kwa">&lt;post</span><span class="hl std"> </span><span class="">title</span><span class="hl std">=</span><span class="hl str">"ocaml-printf"</span><span class="hl std">
</span><span class="">date</span><span class="hl std">=</span><span class="hl str">"2014/01/16"</span><span class="hl std">
</span><span class="">topics</span><span class="hl std">=</span><span class="hl str">"stog"</span><span class="hl std">
</span><span class="">keywords</span><span class="hl std">=</span><span class="hl str">"ocaml, evaluation, code, print"</span><span class="hl std">
</span><span class="">published</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">
Since </span><span class="hl kwa">&lt;doc</span><span class="hl std"> </span><span class="">href</span><span class="hl std">=</span><span class="hl str">"release-0.10.0"</span><span class="hl kwa">/&gt;</span><span class="hl std">, the </span><span class="hl kwa">&lt;rule</span><span class="hl kwa">&gt;</span><span class="hl std">ocaml-printf</span><span class="hl kwa">&lt;/rule</span><span class="hl kwa">&gt;</span><span class="hl std"> rule
can be used to access the content of computed OCaml values, as
strings.
</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;sep_</span><span class="hl kwa">/&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;prepare-toc</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;toc</span><span class="hl kwa">/&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;section</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">"first"</span><span class="hl std"> </span><span class="">title</span><span class="hl std">=</span><span class="hl str">"First example"</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">
Let's take a first example. Suppose we evaluated some OCaml code
with the following rule:
</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;div</span><span class="hl std"> </span><span class="">class</span><span class="hl std">=</span><span class="hl str">"hide"</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">"code1"</span><span class="hl kwa">&gt;</span><span class="hl std">&lt;![CDATA[
</span><span class="hl kwa">&lt;ocaml-eval</span><span class="hl std"> </span><span class="">show-code</span><span class="hl std">=</span><span class="hl str">"false"</span><span class="hl kwa">&gt;</span><span class="hl std">let x = "Hello world!";;</span><span class="hl kwa">&lt;/ocaml-eval</span><span class="hl kwa">&gt;</span><span class="hl std">
]]&gt;</span><span class="hl kwa">&lt;/div</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;hcode</span><span class="hl std"> </span><span class="">lang</span><span class="hl std">=</span><span class="hl str">"xml"</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"1"</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;include</span><span class="hl std"> </span><span class="">href</span><span class="hl std">=</span><span class="hl str">"#code1"</span><span class="hl std"> </span><span class="">subs-only</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl kwa">/&gt;</span><span class="hl kwa">&lt;/hcode</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;as-xml</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"1"</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;include</span><span class="hl std"> </span><span class="">subs-only</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl std"> </span><span class="">href</span><span class="hl std">=</span><span class="hl str">"#code1"</span><span class="hl kwa">/&gt;</span><span class="hl kwa">&lt;/as-xml</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">
Now we can get the contents of </span><span class="hl kwa">&lt;code</span><span class="hl kwa">&gt;</span><span class="hl std">x</span><span class="hl kwa">&lt;/code</span><span class="hl kwa">&gt;</span><span class="hl std"> as a string
to include in our document using the new rule:
</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;div</span><span class="hl std"> </span><span class="">class</span><span class="hl std">=</span><span class="hl str">"hide"</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">"code1p"</span><span class="hl kwa">&gt;</span><span class="hl std">&lt;![CDATA[
The value of </span><span class="hl kwa">&lt;code</span><span class="hl kwa">&gt;</span><span class="hl std">x</span><span class="hl kwa">&lt;/code</span><span class="hl kwa">&gt;</span><span class="hl std"> is: </span><span class="hl kwa">&lt;ocaml-printf</span><span class="hl kwa">&gt;</span><span class="hl std">x</span><span class="hl kwa">&lt;/ocaml-printf</span><span class="hl kwa">&gt;</span><span class="hl std">
]]&gt;</span><span class="hl kwa">&lt;/div</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;hcode</span><span class="hl std"> </span><span class="">lang</span><span class="hl std">=</span><span class="hl str">"xml"</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"1"</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;include</span><span class="hl std"> </span><span class="">subs-only</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl std"> </span><span class="">href</span><span class="hl std">=</span><span class="hl str">"#code1p"</span><span class="hl kwa">/&gt;</span><span class="hl kwa">&lt;/hcode</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwb">&amp;#x21b3;</span><span class="hl std"> </span><span class="hl kwa">&lt;as-xml</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"1"</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;include</span><span class="hl std"> </span><span class="">subs-only</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl std"> </span><span class="">href</span><span class="hl std">=</span><span class="hl str">"#code1p"</span><span class="hl kwa">/&gt;</span><span class="hl kwa">&lt;/as-xml</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;/section</span><span class="hl kwa">&gt;</span><span class="hl std">

</span><span class="hl kwa">&lt;section</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">"formats"</span><span class="hl std"> </span><span class="">title</span><span class="hl std">=</span><span class="hl str">"Formatting"</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">
The </span><span class="hl kwa">&lt;rule</span><span class="hl kwa">&gt;</span><span class="hl std">ocaml-printf</span><span class="hl kwa">&lt;/rule</span><span class="hl kwa">&gt;</span><span class="hl std"> rule builds some OCaml code of the form:
</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;ocaml</span><span class="hl kwa">&gt;</span><span class="hl std">Printf.sprintf "</span><span class="hl kwb">&amp;lt;</span><span class="hl std">format</span><span class="hl kwb">&amp;gt;</span><span class="hl std">" </span><span class="hl kwb">&amp;lt;</span><span class="hl std">code</span><span class="hl kwb">&amp;gt;</span><span class="hl kwa">&lt;/ocaml</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">The </span><span class="hl kwa">&lt;code</span><span class="hl kwa">&gt;</span><span class="hl kwb">&amp;lt;</span><span class="hl std">code</span><span class="hl kwb">&amp;gt;</span><span class="hl kwa">&lt;/code</span><span class="hl kwa">&gt;</span><span class="hl std"> is the contents of the </span><span class="hl kwa">&lt;rule</span><span class="hl kwa">&gt;</span><span class="hl std">ocaml-printf</span><span class="hl kwa">&lt;/rule</span><span class="hl kwa">&gt;</span><span class="hl std">
node, and </span><span class="hl kwa">&lt;code</span><span class="hl kwa">&gt;</span><span class="hl kwb">&amp;lt;</span><span class="hl std">format</span><span class="hl kwb">&amp;gt;</span><span class="hl kwa">&lt;/code</span><span class="hl kwa">&gt;</span><span class="hl std"> is </span><span class="hl kwa">&lt;code</span><span class="hl kwa">&gt;</span><span class="hl std">%s</span><span class="hl kwa">&lt;/code</span><span class="hl kwa">&gt;</span><span class="hl std"> by default.
Another format can be used by setting the </span><span class="hl kwa">&lt;code</span><span class="hl kwa">&gt;</span><span class="hl std">format</span><span class="hl kwa">&lt;/code</span><span class="hl kwa">&gt;</span><span class="hl std"> attribute
like in the following example:
</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;div</span><span class="hl std"> </span><span class="">class</span><span class="hl std">=</span><span class="hl str">"hide"</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">"code2p"</span><span class="hl kwa">&gt;</span><span class="hl std">&lt;![CDATA[
1 + 2 = </span><span class="hl kwa">&lt;ocaml-printf</span><span class="hl std"> </span><span class="">format</span><span class="hl std">=</span><span class="hl str">"%d"</span><span class="hl kwa">&gt;</span><span class="hl std">(1+2)</span><span class="hl kwa">&lt;/ocaml-printf</span><span class="hl kwa">&gt;</span><span class="hl std">
]]&gt;</span><span class="hl kwa">&lt;/div</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;hcode</span><span class="hl std"> </span><span class="">lang</span><span class="hl std">=</span><span class="hl str">"xml"</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"1"</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;include</span><span class="hl std"> </span><span class="">subs-only</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl std"> </span><span class="">href</span><span class="hl std">=</span><span class="hl str">"#code2p"</span><span class="hl kwa">/&gt;</span><span class="hl kwa">&lt;/hcode</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwb">&amp;#x21b3;</span><span class="hl std"> </span><span class="hl kwa">&lt;as-xml</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"1"</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;include</span><span class="hl std"> </span><span class="">subs-only</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl std"> </span><span class="">href</span><span class="hl std">=</span><span class="hl str">"#code2p"</span><span class="hl kwa">/&gt;</span><span class="hl kwa">&lt;/as-xml</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">Note that the parentheses around the expression in the </span><span class="hl kwa">&lt;rule</span><span class="hl kwa">&gt;</span><span class="hl std">ocaml-printf</span><span class="hl kwa">&lt;/rule</span><span class="hl kwa">&gt;</span><span class="hl std">
node is mandatory, otherwise the </span><span class="hl kwa">&lt;icode</span><span class="hl std"> </span><span class="">lang</span><span class="hl std">=</span><span class="hl str">"ocaml"</span><span class="hl kwa">&gt;</span><span class="hl std">Printf.sprintf "%d" 1+2</span><span class="hl kwa">&lt;/icode</span><span class="hl kwa">&gt;</span><span class="hl std">
would result in an error.
</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">
Of course more compilated format and ocaml expressions can be used:
</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;ocaml-eval</span><span class="hl std"> </span><span class="">toplevel</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl kwa">&gt;</span><span class="hl std">let y = 1 and z = 21.;;</span><span class="hl kwa">&lt;/ocaml-eval</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;div</span><span class="hl std"> </span><span class="">class</span><span class="hl std">=</span><span class="hl str">"hide"</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">"code3p"</span><span class="hl kwa">&gt;</span><span class="hl std">&lt;![CDATA[
</span><span class="hl kwa">&lt;ocaml-printf</span><span class="hl std"> </span><span class="">format</span><span class="hl std">=</span><span class="hl str">"The result of %d + %.2f is %.0f."</span><span class="hl kwa">&gt;</span><span class="hl std">y z ((float y) +. z)</span><span class="hl kwa">&lt;/ocaml-printf</span><span class="hl kwa">&gt;</span><span class="hl std">
]]&gt;</span><span class="hl kwa">&lt;/div</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;hcode</span><span class="hl std"> </span><span class="">lang</span><span class="hl std">=</span><span class="hl str">"xml"</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"1"</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;include</span><span class="hl std"> </span><span class="">subs-only</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl std"> </span><span class="">href</span><span class="hl std">=</span><span class="hl str">"#code3p"</span><span class="hl kwa">/&gt;</span><span class="hl kwa">&lt;/hcode</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwb">&amp;#x21b3;</span><span class="hl std"> </span><span class="hl kwa">&lt;as-xml</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"1"</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;include</span><span class="hl std"> </span><span class="">subs-only</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl std"> </span><span class="">href</span><span class="hl std">=</span><span class="hl str">"#code3p"</span><span class="hl kwa">/&gt;</span><span class="hl kwa">&lt;/as-xml</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;/section</span><span class="hl kwa">&gt;</span><span class="hl std">

</span><span class="hl kwa">&lt;section</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">"xml"</span><span class="hl std"> </span><span class="">title</span><span class="hl std">=</span><span class="hl str">"Using result as XML"</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">
The result of </span><span class="hl kwa">&lt;rule</span><span class="hl kwa">&gt;</span><span class="hl std">ocaml-printf</span><span class="hl kwa">&lt;/rule</span><span class="hl kwa">&gt;</span><span class="hl std"> is considered as CDATA in the XML document:
</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;hcode</span><span class="hl std"> </span><span class="">lang</span><span class="hl std">=</span><span class="hl str">"xml"</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"1"</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;include</span><span class="hl std"> </span><span class="">file</span><span class="hl std">=</span><span class="hl str">"./ocaml-printf-code.foo"</span><span class="hl std"> </span><span class="">raw</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl kwa">/&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;/hcode</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">
is rewritten </span><span class="hl kwa">&lt;as-xml</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"1"</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;include</span><span class="hl std"> </span><span class="">file</span><span class="hl std">=</span><span class="hl str">"./ocaml-printf-code.foo"</span><span class="hl std"> </span><span class="">raw</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl kwa">/&gt;</span><span class="hl kwa">&lt;/as-xml</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">
Let's define a list:
</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;ocaml-eval</span><span class="hl std"> </span><span class="">toplevel</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl kwa">&gt;</span><span class="hl std">let my_list = [ 101 ; 202 ; 303 ; 404 ];;</span><span class="hl kwa">&lt;/ocaml-eval</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">The </span><span class="hl kwa">&lt;doc</span><span class="hl std"> </span><span class="">href</span><span class="hl std">=</span><span class="hl str">"module_base#as-xml"</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;rule</span><span class="hl kwa">&gt;</span><span class="hl std">as-xml</span><span class="hl kwa">&lt;/rule</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;/doc</span><span class="hl kwa">&gt;</span><span class="hl std"> rule can be used to
parse the result of </span><span class="hl kwa">&lt;rule</span><span class="hl kwa">&gt;</span><span class="hl std">ocaml-printf</span><span class="hl kwa">&lt;/rule</span><span class="hl kwa">&gt;</span><span class="hl std"> as XML, using the </span><span class="hl kwa">&lt;code</span><span class="hl kwa">&gt;</span><span class="hl std">defer_</span><span class="hl kwa">&lt;/code</span><span class="hl kwa">&gt;</span><span class="hl std">
attribute to compute the contents of the node first:
</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;hcode</span><span class="hl std"> </span><span class="">lang</span><span class="hl std">=</span><span class="hl str">"xml"</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">"code5p"</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"1"</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;include</span><span class="hl std"> </span><span class="">file</span><span class="hl std">=</span><span class="hl str">"./ocaml-printf-table.foo"</span><span class="hl std"> </span><span class="">raw</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl kwa">/&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;/hcode</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">This gives the following table:</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;as-xml</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"1"</span><span class="hl kwa">&gt;</span><span class="hl kwa">&lt;include</span><span class="hl std"> </span><span class="">file</span><span class="hl std">=</span><span class="hl str">"./ocaml-printf-table.foo"</span><span class="hl std"> </span><span class="">raw</span><span class="hl std">=</span><span class="hl str">"true"</span><span class="hl kwa">/&gt;</span><span class="hl kwa">&lt;/as-xml</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">
As shown above, the parsed XML is then rewritten during the rest of the
evaluation process.
The current value of </span><span class="hl kwa">&lt;code</span><span class="hl kwa">&gt;</span><span class="hl std">foo</span><span class="hl kwa">&lt;/code</span><span class="hl kwa">&gt;</span><span class="hl std"> is
</span><span class="hl kwa">&lt;ocaml-printf</span><span class="hl std"> </span><span class="">defer_</span><span class="hl std">=</span><span class="hl str">"3"</span><span class="hl std"> </span><span class="">format</span><span class="hl std">=</span><span class="hl str">"%d"</span><span class="hl kwa">&gt;</span><span class="hl std">foo</span><span class="hl kwa">&lt;/ocaml-printf</span><span class="hl kwa">&gt;</span><span class="hl std">.
</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;/section</span><span class="hl kwa">&gt;</span><span class="hl std">

</span><span class="hl kwa">&lt;section</span><span class="hl std"> </span><span class="">id</span><span class="hl std">=</span><span class="hl str">"sessions"</span><span class="hl std"> </span><span class="">title</span><span class="hl std">=</span><span class="hl str">"Sessions"</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">
The </span><span class="hl kwa">&lt;code</span><span class="hl kwa">&gt;</span><span class="hl std">session</span><span class="hl kwa">&lt;/code</span><span class="hl kwa">&gt;</span><span class="hl std"> attribute is honored:
</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;hxml</span><span class="hl kwa">&gt;</span><span class="hl std">&lt;![CDATA[</span><span class="hl kwa">&lt;ocaml-printf</span><span class="hl std"> </span><span class="">session</span><span class="hl std">=</span><span class="hl str">"..."</span><span class="hl std"> ...</span><span class="hl kwa">&gt;</span><span class="hl std">...</span><span class="hl kwa">&lt;/ocaml-printf</span><span class="hl kwa">&gt;</span><span class="hl std">]]&gt;</span><span class="hl kwa">&lt;/hxml</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;p</span><span class="hl kwa">&gt;</span><span class="hl std">See </span><span class="hl kwa">&lt;doc</span><span class="hl std"> </span><span class="">href</span><span class="hl std">=</span><span class="hl str">"ocaml-sessions"</span><span class="hl kwa">&gt;</span><span class="hl std">this post</span><span class="hl kwa">&lt;/doc</span><span class="hl kwa">&gt;</span><span class="hl std"> for details about OCaml sessions.</span><span class="hl kwa">&lt;/p</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;/section</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;/prepare-toc</span><span class="hl kwa">&gt;</span><span class="hl std">
</span><span class="hl kwa">&lt;/post</span><span class="hl kwa">&gt;</span></pre>
</div>

<div id="footer">
<div class="generatedon">Generated on May 3, 2017 at 8h57</div>
</div>
<!--&lt;script type="text/javascript" src="&lt;site-url/&gt;/jquery.js"&gt;_&lt;/script&gt;-->
<!--&lt;script type="text/javascript" src="&lt;site-url/&gt;/bootstrap-collapse.js"&gt;_&lt;/script&gt;-->

</div> <!-- #page -->
</body>
</html>
